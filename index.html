<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>3D Lamp</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
  <div id="lamp" style="width:100%;height:100vh;"></div>
  <script>
    // Kích thước
    let base_big = 16, base_small = 8, height = 20;

    // Đỉnh đáy lớn
    let B = [
      [-base_big/2, -base_big/2, 0],
      [ base_big/2, -base_big/2, 0],
      [ base_big/2,  base_big/2, 0],
      [-base_big/2,  base_big/2, 0]
    ];
    // Đỉnh đáy nhỏ
    let S = [
      [-base_small/2, -base_small/2, height],
      [ base_small/2, -base_small/2, height],
      [ base_small/2,  base_small/2, height],
      [-base_small/2,  base_small/2, height]
    ];

    // Các mặt chóp cụt
    let faces = [
      [B[0],B[1],B[2],B[3]],
      [S[0],S[1],S[2],S[3]],
      [B[0],B[1],S[1],S[0]],
      [B[1],B[2],S[2],S[1]],
      [B[2],B[3],S[3],S[2]],
      [B[3],B[0],S[0],S[3]],
    ];

    let lampData = faces.map(f => ({
      type: "mesh3d",
      x: f.map(p => p[0]),
      y: f.map(p => p[1]),
      z: f.map(p => p[2]),
      opacity: 0.5,   // trong suốt để nhìn thấy bóng đèn
      color: "gold"
    }));

    // ===== Khung nâu =====
    let frame_thickness = 2, frame_height = 1;
    let B_outer = [
      [-base_big/2-frame_thickness, -base_big/2-frame_thickness, 0],
      [ base_big/2+frame_thickness, -base_big/2-frame_thickness, 0],
      [ base_big/2+frame_thickness,  base_big/2+frame_thickness, 0],
      [-base_big/2-frame_thickness,  base_big/2+frame_thickness, 0]
    ];
    let B_outer_top = B_outer.map(([x,y,z]) => [x,y,frame_height]);
    let B_inner_top = B.map(([x,y,z]) => [x,y,frame_height]);

    let frame_faces = [
      B_outer, B_outer_top,
      [B_outer[0],B_outer[1],B_inner_top[1],B_inner_top[0]],
      [B_outer[1],B_outer[2],B_inner_top[2],B_inner_top[1]],
      [B_outer[2],B_outer[3],B_inner_top[3],B_inner_top[2]],
      [B_outer[3],B_outer[0],B_inner_top[0],B_inner_top[3]],
    ];
    frame_faces.forEach(f => lampData.push({
      type: "mesh3d",
      x: f.map(p => p[0]),
      y: f.map(p => p[1]),
      z: f.map(p => p[2]),
      opacity: 0.9,
      color: "saddlebrown"
    }));

    // ===== Bóng đèn vàng (scatter3d dạng cầu) =====
    let cx=0, cy=0, cz=5, r=3;
    let x=[], y=[], z=[];
    for (let theta=0; theta<=Math.PI; theta+=Math.PI/20) {
      for (let phi=0; phi<=2*Math.PI; phi+=Math.PI/20) {
        x.push(cx + r*Math.sin(theta)*Math.cos(phi));
        y.push(cy + r*Math.sin(theta)*Math.sin(phi));
        z.push(cz + r*Math.cos(theta));
      }
    }
    lampData.push({
      type: "scatter3d",
      mode: "markers",
      x: x, y: y, z: z,
      marker: {size: 2, color: "gold", opacity: 0.9}
    });

    // Vẽ
    Plotly.newPlot("lamp", lampData, {
      scene: {aspectmode: "data"},
      margin: {l:0,r:0,t:0,b:0}
    });
  </script>
</body>
</html>
