<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>3D Lamp</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
  <div id="lamp" style="width:100%;height:100vh;"></div>
  <script>
    // Kích thước
    let base_big = 16, base_small = 8, height = 20;

    // Đỉnh đáy lớn
    let B = [
      [-base_big/2, -base_big/2, 0],
      [ base_big/2, -base_big/2, 0],
      [ base_big/2,  base_big/2, 0],
      [-base_big/2,  base_big/2, 0]
    ];
    // Đỉnh đáy nhỏ
    let S = [
      [-base_small/2, -base_small/2, height],
      [ base_small/2, -base_small/2, height],
      [ base_small/2,  base_small/2, height],
      [-base_small/2,  base_small/2, height]
    ];

    // Các mặt chóp cụt
    let faces = [
      [B[0],B[1],B[2],B[3]],
      [S[0],S[1],S[2],S[3]],
      [B[0],B[1],S[1],S[0]],
      [B[1],B[2],S[2],S[1]],
      [B[2],B[3],S[3],S[2]],
      [B[3],B[0],S[0],S[3]],
    ];

    let lampData = faces.map(f => ({
      type: "mesh3d",
      x: f.map(p => p[0]),
      y: f.map(p => p[1]),
      z: f.map(p => p[2]),
      opacity: 0.6,
      color: "lightblue"
    }));

    // ===== Khung nâu =====
    let frame_thickness = 2, frame_height = 1;
    let B_outer = [
      [-base_big/2-frame_thickness, -base_big/2-frame_thickness, 0],
      [ base_big/2+frame_thickness, -base_big/2-frame_thickness, 0],
      [ base_big/2+frame_thickness,  base_big/2+frame_thickness, 0],
      [-base_big/2-frame_thickness,  base_big/2+frame_thickness, 0]
    ];
    let B_outer_top = B_outer.map(([x,y,z]) => [x,y,frame_height]);
    let B_inner_top = B.map(([x,y,z]) => [x,y,frame_height]);

    let frame_faces = [
      B_outer, B_outer_top,
      [B_outer[0],B_outer[1],B_inner_top[1],B_inner_top[0]],
      [B_outer[1],B_outer[2],B_inner_top[2],B_inner_top[1]],
      [B_outer[2],B_outer[3],B_inner_top[3],B_inner_top[2]],
      [B_outer[3],B_outer[0],B_inner_top[0],B_inner_top[3]],
    ];
    frame_faces.forEach(f => lampData.push({
      type: "mesh3d",
      x: f.map(p => p[0]),
      y: f.map(p => p[1]),
      z: f.map(p => p[2]),
      opacity: 0.9,
      color: "saddlebrown"
    }));

    // ===== Bóng đèn vàng (hình cầu) =====
    function createSphere(cx, cy, cz, r, steps=20) {
      let x = [], y = [], z = [];
      for (let i = 0; i <= steps; i++) {
        let theta = i * Math.PI / steps;
        let rowX = [], rowY = [], rowZ = [];
        for (let j = 0; j <= steps; j++) {
          let phi = j * 2 * Math.PI / steps;
          rowX.push(cx + r * Math.sin(theta) * Math.cos(phi));
          rowY.push(cy + r * Math.sin(theta) * Math.sin(phi));
          rowZ.push(cz + r * Math.cos(theta));
        }
        x.push(rowX); y.push(rowY); z.push(rowZ);
      }
      return {x, y, z};
    }

    let bulb = createSphere(0, 0, frame_height + 3, 3, 30);

    lampData.push({
      type: "surface",
      x: bulb.x,
      y: bulb.y,
      z: bulb.z,
      showscale: false,
      opacity: 0.9,
      colorscale: [[0,"gold"],[1,"gold"]]
    });

    // Vẽ
    Plotly.newPlot("lamp", lampData, {
      scene: {aspectmode: "data"},
      margin: {l:0,r:0,t:0,b:0}
    });
  </script>
</body>
</html>
